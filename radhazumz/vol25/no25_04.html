<html>
<head>

<title>On weak rotors, Latin squares, linear algebraic representations, invariant differentials
and cryptanalysis of Enigma</title>

<meta name="description" content="Rad HAZU, Vol.25, 51-77">

</head>

<!-- 
<body bgcolor="#FFDD77">
-->

<h4>Rad HAZU, Matemati&#269;ke znanosti, Vol. 25 (2021), 51-77.</h4>

<h3 align=center>ON WEAK ROTORS, LATIN SQUARES, LINEAR ALGEBRAIC REPRESENTATIONS, INVARIANT
DIFFERENTIALS AND CRYPTANALYSIS OF ENIGMA</h3>
<h3 align=center>Nicolas T. Courtois, Marek Grajek and Michal Rams</h3>

University College London, Gower Street, London, UK <br>
<em>e-mail:</em> <tt>n.courtois@ucl.ac.uk</tt> 
<p>
Independent expert on crypto history, Grodzisk Mazowiecki, Poland <br>
<em>e-mail:</em> <tt>mjg@interia.eu</tt> 
<p>
Institute of Mathematics, Polish Academy of Sciences, Warsaw, Poland <br>
<em>e-mail:</em> <tt>rams@impan.pl</tt> 

<p>
<hr size=2 noshade>
<p>


<b>Abstract.</b> &nbsp; Since the 1920s until today it was assumed that rotors in
Enigma cipher machines do not have a particular weakness or structure. A
curious situation compared to hundreds of papers about S-boxes and weak
setup in block ciphers. In this paper we reflect on what is normal and what
is not normal for a cipher machine rotor, with a reference point being a
truly random permutation. Our research shows that most original wartime
Enigma rotors ever made are not at all random permutations and conceal
strong differential properties invariant by rotor rotation. We also exhibit
linear/algebraic properties pertaining to the ring of integers modulo 26.
Some rotors are imitating a certain construction of a perfect quasigroup
which however only works when <i>N</i> is odd. Most other rotors are simply
trying to approximate the ideal situation. To the best of our knowledge
these facts are new and were not studied before 2020.

<p>
<b>2020 Mathematics Subject Classification.</b> &nbsp; 
94A60, 68P25, 20N05, 05B15, 13A50.
<p>
<b>Key words and phrases.</b> &nbsp; Enigma, block ciphers, linear cryptanalysis, differential cryptanalysis,
weak keys, Latin squares, algebraic representation, quasigroups, Turing-Welchman attack.
<p>

<hr size=2 noshade>

<a href="https://hrcak.srce.hr/file/380446"><b>Full text (PDF)</b></a> (free access)
<p>

DOI: <a href="https://doi.org/10.21857/y26kec4k89">https://doi.org/10.21857/y26kec4k89</a>

<hr size=2 noshade>
<p>
<b>References:</b>
<small>
<ol>

<li> A. Albertini, J.-P. Aumasson, M. Eichlseder, F. Mendel and M. Schläffer, <i>Malicious
hashing: Eve's variant of SHA-1</i>, in: 
Selected Areas in Cryptography - SAC 2014, Lecture Notes in Comput. Sci. <b>8781</b>, 
Springer, Cham, 2014. pp. 1-19.
<br>
<a href="https://www.ams.org/mathscinet-getitem?mr=3333254">MathSciNet</a> &nbsp; &nbsp; 
<a href="https://doi.org/10.1007/978-3-319-13051-4_1">CrossRef</a>
<p>

<li> D. Alvarez, <i>Wilhelm Fenner and the development of the German Cipher Bureau</i>, 1922-1939, 
Cryptologia <b>31</b> (2007), 152-163.
<br>
<a href="https://doi.org/10.1080/01611190601038225">CrossRef</a>
<p>

<li> G. V. Bard, S. V. Ault and N. T. Courtois, <i>Statistics of random permutations and the
cryptanalysis of periodic block ciphers</i>, Cryptologia <b>36</b> (2012), 240-262.
<br>
<a href="https://doi.org/10.1080/01611194.2011.632806">CrossRef</a>
<p>

<li> M. Batey, <i>Dilly Knox - A reminiscence of this pioneer Enigma cryptanalyst</i>, 
Cryptologia <b>32</b> (2008), 104-130.
<br>
<a href="https://doi.org/10.1080/01611190801914290">CrossRef</a>
<p>

<li> F. L. Bauer, Decrypted Secrets: Methods and Maxims of Cryptology, Springer, Berlin, 2006.
<br>
<a href="https://www.ams.org/mathscinet-getitem?mr=2274689">MathSciNet</a> 
<p>

<li> L. P. Brown, Analysis of the DES and the Design of the LOKI Encryption Scheme,
PhD Thesis, Dept. Computer Science, UC UNSW, ADFA, Canberra, 1991.
<p>

<li> M. Calderini, <i>A note on some algebraic trapdoors for block ciphers</i>, 
Adv. Math. Commun. <b>12</b> (2018), 515-524.
<br>
<a href="https://www.ams.org/mathscinet-getitem?mr=836572">MathSciNet</a> &nbsp; &nbsp; 
<a href="https://doi.org/10.3934/amc.2018030">CrossRef</a>
<p>

<li> N. T. Courtois, <i>Si seulement Enigma tournait moins vite, ou cryptanalyse d'Enigma
avec un rotor faible</i>, Bulletin de l'Association des R&eacute;servistes du Chiffre et de la S&eacute;écurit&eacute;
de l'Information, <b>46</b> (2020), 79-90. 
<p>

<li> N. T. Courtois, Student exercises about breaking Enigma, updated March 2020,
taught at University College London in 2020 as a part of COMP0058 Allied Cryptography
and Cryptanalysis course, <br>
<a href="http://www.nicolascourtois.com/teach/Exos_Engima_0058.pdf"><tt>http://www.nicolascourtois.com/teach/Exos_Engima_0058.pdf</tt></a>.
<p>

<li> N. Courtois, Algebraic Complexity Reduction and Cryptanalysis of GOST, Monograph
study on GOST cipher, 224 pages, available at 
<a href="https://ia.cr/2011/626"><tt>https://ia.cr/2011/626</tt></a>.
<p>

<li> N. Courtois and J. Pieprzyk, <i>Cryptanalysis of block ciphers with overdefined systems
of equations</i>, in: in: Advances in Cryptology -- ASIACRYPT 2002, Lecture Notes in Comput. Sci. <b>2501</b>, 
Springer, Berlin, 2002. pp. 267-287.
<br>
<a href="https://www.ams.org/mathscinet-getitem?mr=2087390">MathSciNet</a> &nbsp; &nbsp; 
<a href="https://doi.org/10.1007/3-540-36178-2_17">CrossRef</a>
<p>

<li> N. T. Courtois and A. Patrick, <i>Lack of unique factorization as a tool in block cipher
cryptanalysis</i>, Preprint, 
<a href="https://arxiv.org/abs/1905.04684"><tt>https://arxiv.org/abs/1905.04684</tt></a>, submitted 12 May 2019.
<p>

<li> N. T. Courtois, <i>On the existence of non-linear invariants and algebraic polynomial
constructive approach to backdoors in block ciphers</i>, 
<a href="https://ia.cr/2018/807"><tt>https://ia.cr/2018/807</tt></a>, last revised 27 Mar 2019.
<p>

<li> N. T. Courtois, <i>A nonlinear invariant attack on T-310 with the original Boolean
function</i>, Cryptologia <b>45</b> (2021), 178-192.
<br>
<a href="https://doi.org/10.1080/01611194.2020.1736207">CrossRef</a>
<p>

<li> N. Courtois, <i>The inverse S-box, non-linear polynomial relations and cryptanalysis of
block ciphers</i>, in: Advanced Encryption Standard - AES, Lecture Notes in Comput. Sci. <b>3373</b>, 
Springer, Berlin, 2005, pp. 170-188.
<br>
<a href="https://doi.org/10.1007/11506447_15">CrossRef</a>
<p>

<li> N. Courtois, <i>Feistel schemes and bi-linear cryptanalysis</i>, in: 
Advances in Cryptology - CRYPTO 2004, Lecture Notes in Comput. Sci. <b>3152</b>, 
Springer, Berlin, 2004. pp. 23-40.
<br>
<a href="https://www.ams.org/mathscinet-getitem?mr=2147493">MathSciNet</a> &nbsp; &nbsp; 
<a href="https://doi.org/10.1007/978-3-540-28628-8_2">CrossRef</a>
<p>

<li> N. T. Courtois, K. Schmeh, J. Drobick, J. Patarin, M.-B. Oprisanu, M. Scarlata
and O. Bhallamudi, Cryptographic Security Analysis of T-310, Monography study on
the T-310 block cipher, 132 pages, received 20 May 2017, last revised 29 June 2018, <br>
<a href="https://ia.cr/2017/440.pdf"><tt>https://ia.cr/2017/440.pdf</tt></a>.
<p>

<li> N. Courtois, 100 years of Cryptanalysis: Compositions of Permutations, slides
about cryptanalysis of Engima and block cipher cryptanalysis, used teaching
GA18 Cryptanalysis course at University College London 2014-2016, <br>
<a href="http://www.nicolascourtois.com/papers/code_breakers_enigma_block_teach.pdf"><tt>http://www.nicolascourtois.com/papers/code_breakers_enigma_block_teach.pdf</tt></a>.
<p>

<li> N. Courtois, M.-B. Oprisanu and K. Schmeh, <i>Linear cryptanalysis and block cipher
design in East Germany in the 1970s</i>, Cryptologia <b>43</b> (2019), 2-22.
<br>
<a href="https://doi.org/10.1080/01611194.2018.1483981">CrossRef</a>
<p>

<li> N. Courtois and J. Pieprzyk, <i>Cryptanalysis of block ciphers with overdefined systems
of equations</i>, in: Advances in Cryptology - ASIACRYPT 2002, Lecture Notes in Comput. Sci. <b>2501</b>, 
Springer, Berlin, 2002. pp. 267-287.
<br>
<a href="https://www.ams.org/mathscinet-getitem?mr=2087390">MathSciNet</a> &nbsp; &nbsp; 
<a href="https://doi.org/10.1007/3-540-36178-2_17">CrossRef</a>
<p>

<li> N. T. Courtois, <i>Invariant hopping attacks on block ciphers</i>, presented at WCC’2019,
Abbaye de Saint-Jacut de la Mer, France, 31 March - 5 April 2019. <br> 
Extended version
available at <a href="https://arxiv.org/pdf/2002.03212.pdf"><tt>https://arxiv.org/pdf/2002.03212.pdf</tt></a>, 8 February 2020.
<p>

<li> N. Courtois, G. Castagnos and L. Goubin, <i>What do DES S-boxes say to each other?</i>,
Available on <a href="https://ia.cr/2003/184/"><tt>https://ia.cr/2003/184/</tt></a>.
<p>

<li> N. Courtois, <i>The best differential characteristics and subtleties of the Biham-Shamir
attacks on DES</i>, Available on <a href="https://ia.cr/2005/202"><tt>https://ia.cr/2005/202</tt></a>.
<br>
<a href="https://www.ams.org/mathscinet-getitem?mr=2773911">MathSciNet</a> &nbsp; &nbsp; 
<a href="https://doi.org/10.1007/978-3-540-77272-9_10">CrossRef</a>
<p>

<li> N. T. Courtois, T. Mourouzis, M. Misztal, J.-J. Quisquater and G. Song, <i>Can GOST
be made secure against differential cryptanalysis?</i>, Cryptologia <b>39</b> (2015), 145-156.
<br>
<a href="https://doi.org/10.1080/01611194.2014.915266">CrossRef</a>
<p>

<li> N. T. Courtois and J.-J. Quisquater, Can a differential attack work for an arbitrarily
large number of rounds?, in: Information Security and Cryptology - ICISC 2020, Lecture Notes in Comput. Sci. <b>12593</b>, 
Springer, Cham, 2021, pp. 157-181.
<br>
<a href="https://doi.org/10.1007/978-3-030-68890-5_9">CrossRef</a>
<p>

<li> C. Eyraud, Pr&eacute;cis de Cryptographie Moderne, Editions Raoul Tari, Paris, 1st edition
1953, 2nd edition 1959.
<p>

<li> P. Flajolet and R. Sedgewick, Analytic Combinatorics, Cambridge University Press, Cambridge, 2009.
<br>
<a href="https://www.ams.org/mathscinet-getitem?mr=2483235">MathSciNet</a> &nbsp; &nbsp; 
<a href="https://doi.org/10.1017/CBO9780511801655">CrossRef</a>
<p>

<li> J. R. S. Fuensanta, F. J. López-Brea Espiau, and F. Weierud, <i>Spanish Enigma: A
history of the Enigma in Spain</i>, Cryptologia <b>34</b> (2010), 301-328.
<br>
<a href="https://doi.org/10.1080/01611194.2010.485414">CrossRef</a>
<p>

<li> J. J. Gillogly, <i>Ciphertext-only cryptanalysis of Enigma</i>, Cryptologia <b>19</b> (1995), 405-413.
<br>
<a href="https://doi.org/10.1080/0161-119591884060">CrossRef</a>
<p>

<li> I. J. Good and C. A. Deavours, <i>Afterword to: Marian Rejewski, "How Polish mathematicians
deciphered the Enigma"</i>, Annals of the History of Computing <b>3 (3)</b> (1981), 229-232.
<p>

<li> C. Jennings, The Third Reich is Listening: Inside German codebreaking 1939-45,
Osprey Publishing, Oxford, 2018.
<p>

<li> D. Kahn, <i>How I discovered World War II's greatest spy</i>, Cryptologia <b>34</b> (2009), 12-21.
<br>
<a href="https://doi.org/10.1080/01611190903385019">CrossRef</a>
<p>

<li> P. Morawiecki, Malicious Keccak, 
<a href="https://ia.cr/2015/1085"><tt>https://ia.cr/2015/1085</tt></a>.
<p>

<li> T. Peyrin and H. Wang, The MALICIOUS framework: Embedding backdoors into
tweakable block ciphers, in: Advances in Cryptology - CRYPTO 2020, Lecture Notes in Comput. Sci. <b>12172</b>, 
Springer, Cham, pp. 249-278.
<br>
<a href="https://doi.org/10.1007/978-3-030-56877-1_9">CrossRef</a>
<p>

<li> K. Pommerening, <i>Permutations and Rejewski’s Theorem</i>, <br>
<a href="https://www.staff.unimainz.de/pommeren/MathMisc/Permut.pdf"><tt>https://www.staff.unimainz.de/pommeren/MathMisc/Permut.pdf</tt></a>.
<p>

<li> S. Ree, <i>Choi Seokjeong and traditional Asian mathematics, Confucian scholar's discovery
predates the work of Euler</i>, In page 3 of Math & Presso, Daily News of the Congress,
No 3, Friday 15 August 2014, printed and edited by Korea JoongAng Daily newspaper,
publication commissioned by the International Congress of Mathematicians, ICM
2014, Seoul, Korea. Available on 
<a href="http://www.icm2014.org/download/MP0815.pdf"><tt>http://www.icm2014.org/download/MP0815.pdf</tt></a>.
<p>

<li> M. Rejewski, H. Zygalski and other undisclosed authors, Kurzgefasste Darstellung der
Aufl&ouml;sungsmethoden, Bertrand archives, Service Historique de la D&eacute;fense, Vincennes,
France, DE 2016 ZB 25/6, Dossiers Nos. 281 and 282, ca. 1940.
<p>

<li> M. Rejewski, Memories of My Work at the Cipher Bureau of the General Staff Second
Department 1930-45, second edition, Adam Mickiewicz University Press, Poznan, 2011.
<p>

<li> Random Permutation Statistics, Wikipedia article, consulted 14 March 2020, available
at <a href="http://en.wikipedia.org/wiki/Random_permutation_statistics"><tt>http://en.wikipedia.org/wiki/Random_permutation_statistics</tt></a>.
<p>

<li> A. Turing, Mathematical Theory of ENIGMA Machine, UK national archives, c. 1940.
<p>

<li> D. Turing with help of D. Kenyon, The Bombe Breakthrough, blue guide book, sold
by Bletchley Park trust, 96 pages, 2018.
<p>

<li> H. Ulbricht, Die Chiffriermaschine ENIGMA, Tr&uuml;gerische Sicherheit, Ein Beitrag zur
Geschichte der Nachrichtendienste, PhD thesis, Technische Universit&auml;t Braunschweig,
14 April 2005.
<p>


</ol>
</small>

<hr size=2 noshade>

<a href="http://web.math.pmf.unizg.hr/~duje/radhazumz/"><em>Rad HAZU</em> Home Page</a>

</body>

</html>

