<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Jo&#353; neki moderni blokovni kriptosustavi</title>

<meta name="author" content="Andrej Dujella">
<meta name="description" content="Moderni blokovni kriptosustavi">
<meta name="keywords" content="kriptografija, trostruki DES, Triple 
DES, IDEA, CAST, CAST-128, RC5">

<meta http-equiv="Content-Type" content="text/html; charset=windows-1250">

<meta name="viewport" content="width=device-width, initial-scale=0.6">

<style type="text/css">
body {font-family: Arial,Helvetica,sans-serif;}
</style>

</head>

<body bgcolor="#FFFFFF">

<b><font size="-1" face="Verdana">
<a href="desan.html">[Prethodno poglavlje]</a> &nbsp; 
<a href="aes.html">[Sljede&#263;e poglavlje]</a> &nbsp;
<a href="kriptografija.html">[Sadr&#382;aj]</a>
</font></b>

<hr size=2 noshade>


<a name="2.6"></a>
<h2 align=center style="color: rgb(128,0,0)">2.6. Jo&#353; neki moderni 
blokovni kriptosustavi</h2>


U naredna dva poglavlja spomenut &#263;emo neke kriptosustave koji se  
koriste kao zamjena za DES, te kriptosustave koji bi trebali 
i slu&#382;beno zamijeniti DES. U ovom poglavlju obradit &#263;emo 
Trostruki DES (Triple DES, 3DES), IDEA, CAST-128 i RC5, dok &#263;emo 
u narednom poglavlju re&#263;i ne&#353;to o finalistima natje&#269;aja za 
nasljednika DES-a. 
<p>

Prije nego &#353;to ka&#382;emo ne&#353;to o Trostrukom DES-u, odgovorimo na pitanje 
za&#353;to se ne koristi &quot;Dvostruki DES&quot;. Kod Dvostrukog DES-a 
bi svaki blok &#353;ifrirali dvaput, s dva razli&#269;ita klju&#269;a 
<i>K</i> i <i>L</i>: 
<p align=center>
<i>y</i> = <i>e</i><sub><i>L</i></sub>(<i>e</i><sub><i>K</i></sub>(<i>x</i>)), <br>
<i>x</i> = <i>d</i><sub><i>K</i></sub>(<i>d</i><sub><i>L</i></sub>(<i>y</i>)). 
</p>
Kako smo ve&#263; napomenuli, DES nije grupa, pa se &#269;ini da smo 
ovako dobili znatno sigurniji kriptosustav. Me&#273;utim, postoji 
ne&#353;to &#353;to se zove napad "<em>susret u sredini</em>", koji je opisao 
Diffie 1977. godine. Pretpostavimo da je poznat jedan par 
<i>otvoreni tekst-&#353;ifrat</i> (<i>x</i>,<i>y</i>). &#352;ifriramo <i>x</i> sa svih 
2<sup>56</sup> mogu&#263;ih klju&#269;eva <i>K</i>. Spremimo rezultate u 
tablicu i sortiramo ih po vrijednostima od <i>z</i> = 
<i>e</i><sub><i>K</i></sub>(<i>x</i>). Zatim de&#353;ifriramo <i>y</i> 
koriste&#263;i svih 2<sup>56</sup> mogu&#263;ih klju&#269;eva <i>L</i>. Nakon svakog 
de&#353;ifriranja, potra&#382;imo rezultat u tablici. (Naime, treba vrijediti 
<i>z</i> = <i>d</i><sub><i>L</i></sub>(<i>y</i>).) Ako ga 
prona&#273;emo, onda tako dobiveni par (<i>K</i>,<i>L</i>) testiramo 
na sljede&#263;em poznatom paru otvoreni tekst-&#353;ifrat. Ako pro&#273;u taj test, 
prihva&#263;amo ih za korektne klju&#269;eve. Vjerojatnost da smo pogrije&#353;ili 
je 2<sup>112-64-64</sup> = 2<sup>-16</sup>. Na taj na&#269;in dobivamo  
da je za razbijanje Dvostrukog DES-a broj operacija 
reda 2<sup>56</sup>, &#353;to je neznatno vi&#353;e nego za obi&#269;ni DES. 
<p>

Jedna od najpopularnijih zamjena za DES je <em>Trostruki DES</em> 
(koriste se jo&#353; i nazivi Triple DES i 3DES): 
<p align=center>
<i>y</i> = <i>e</i><sub><i>M</i></sub>(<i>d</i><sub><i>L</i></sub>(<i>e</i><sub><i>K</i></sub>(<i>x</i>))), <br>
<i>x</i> = <i>d</i><sub><i>K</i></sub>(<i>e</i><sub><i>L</i></sub>(<i>d</i><sub><i>M</i></sub>(<i>y</i>))). 
</p>
Ovdje je klju&#269; duljine 56 &middot; 3=168 bitova. &#268;esto se koristi i
verzija u kojoj je <i>M</i> = <i>K</i>, pa je u njoj duljina klju&#269;a 
56 &middot; 2=112, no za nju postoje neki, jo&#353; uvijek nedovoljno prakti&#269;ni napadi,
koji koriste njezinu specifi&#269;nu strukturu.
Razlog za kombinaciju &quot;<i>ede</i>&quot; je kompatibilnost s obi&#269;nim 
DES-om: dovoljno je staviti <i>L</i> = <i>M</i> ili <i>K</i> = <i>L</i>. Za Trostruki DES 
broj operacija kod napada &quot;susret u sredini&quot; je reda 
<nobr>2<sup>112</sup> &asymp; 5 &middot; 10<sup>33</sup></nobr> 
dok je kod diferencijalne kriptoanalize 
procijenjen na 10<sup>52</sup>. Mo&#382;emo re&#263;i da je sigurnost kod 
trostrukog &#353;ifriranja upravo onakva kakvu bismo mo&#382;da naivno 
o&#269;ekivali kod dvostrukog. U svakom slu&#269;aju, sigurnost 3DES-a je 
danas i vi&#353;e nego zadovoljavaju&#263;a.
<p><br>

IDEA (<em>International Data Encryption Algorithm</em>) je kriptosustav 
koji su razvili &#353;vicarski kriptografi 
<font color=009900>Xuejia Lai</font> 
i <font color=009900>James Massey</font> s ETH Z&uuml;rich. Prvu verziju zvanu PES 
(<em>Proposed Encryption Standard</em>) su objavili 1990. Me&#273;utim, 
taj kriptosustav nije bio otporan na diferencijalnu kriptoanalizu 
(za 128-bitni klju&#269; je trebalo 2<sup>64</sup> operacija), pa su 
nakon Biham-Shamirovog otkri&#263;a, autori 1992. godine prepravili 
algoritam i nazvali ga IDEA. 
<p>
IDEA koristi 128-bitni klju&#269; za &#353;ifriranje 64-bitnih blokova otvorenog 
teksta. Koristi tri operacije na 16-bitnim podblokovima: 
<ul>
<li>XOR &nbsp; &nbsp; (oznaka &nbsp; &oplus;),
<li>zbrajanje modulo 2<sup>16</sup> &nbsp; &nbsp; (oznaka &nbsp; &#8862;),
<li>mno&#382;enje modulo 2<sup>16</sup> + 1 &nbsp; &nbsp; (oznaka &nbsp; &#8900;).
</ul>
Mno&#382;enje se ovdje mo&#382;e smatrati analogonom S-kutija u DES-u. 
Modul <nobr>2<sup>16</sup>+1</nobr> je odabran
zbog efikasnije implementacije modularnog mno&#382;enja.
Ove tri operacije 
su inkompatibilne, u smislu da nikoje dvije ne zadovoljavaju 
zakone asocijativnosti i distributivnosti. IDEA ima 8 rundi i 
zavr&#353;nu transformaciju. U njima se koristi 52 16-bitnih me&#273;uklju&#269;eva 
generiranih pomo&#263;u polaznog 128-bitnog klju&#269;a.  
<p align=center>
<img src="slike/idea_rot.gif" alt="idea">
</p><br>

CAST-128 (koristi se jo&#353; i naziv CAST5) su dizajnirali kanadski kriptografi 
<font color=009900>Carlisle Adams</font> i 
<font color=009900>Stafford Taraves</font> 1993. godine. 
CAST &#353;ifrira 64-bitne blokove otvorenog teksta koriste&#263;i klju&#269; &#269;ija 
duljina mo&#382;e varirati od 40 do 128 bitova. CAST je, isto kao i DES, 
primjer Feistelove &#353;ifre sa 16 rundi. Dvije su razlike od klasi&#269;ne 
Feistelove &#353;ifre: 
<ol>
<li>dva me&#273;uklju&#269;a u svakoj rundi: 32-bitni <i>Km<sub>i</sub></i> i 
5-bitni <i>Kr<sub>i</sub></i>;
<li>funkcija <i>f</i> ovisi o rundi.
</ol>
Osnovne operacije u CAST-u su: 
<ul>
<li>XOR,
<li>zbrajanje i oduzimanje modulo 2<sup>32</sup>,
<li>lijeva cikli&#269;ka rotacija od <i>a</i> za <i>b</i> bitova &nbsp; &nbsp; (oznaka &nbsp; <i>a</i> <<< <i>b</i>).
</ul>
Skica jedne CAST-128 runde: 
<p align=center>
<img src="slike/cast128.gif" alt="CAST-128">
</p>
U ovisnosti o rundama, imamo: 
<pre><font size=2>
       runda              f1<sub>i</sub>     f2<sub>i</sub>    f3<sub>i</sub>    f4<sub>i</sub>
-----------------------------------------------------------------
 1, 4, 7, 10, 13, 16       +     XOR     -      + 
-----------------------------------------------------------------
   2, 5, 8, 11, 14        XOR     -      +     XOR
-----------------------------------------------------------------
   3, 6, 9, 12, 15         -      +     XOR     -
-----------------------------------------------------------------      
</font></pre>

<p><br><br>

RC5 algoritam je izumio <font color=009900>Ron Rivest</font> 1994. 
godine. Zapravo to je cijela familija algoritama odre&#273;ena s tri parametra: <br>
&nbsp; &nbsp; &nbsp; <i>w</i> - duljina rije&#269;i u bitovima = 16, 32, 64<br>
&nbsp; &nbsp; &nbsp; <i>r</i> - broj rundi = 0, 1, ... , 255<br>
&nbsp; &nbsp; &nbsp; <i>b</i> - broj bajtova u klju&#269;u = 0, 1, ... , 255<br>
Obi&#269;no se koristi verzija sa <i>w</i> = 32, <i>r</i> = 12, 
<i>b</i> = 12. 
<p>
Osnovne operacije u RC5 su: 
<ul>
<li>XOR,
<li>zbrajanje i oduzimanje modulo 2<sup><i>w</i></sup>,
<li>lijeva i desna cikli&#269;ka rotacija &nbsp; &nbsp; 
(<i>a</i> <<< <i>b</i>, <i>a</i> >>> <i>b</i>).
</ul>
<p>
U &#353;ifriranju se koristi 2<i>r</i>+2 32-bitnih rije&#269;i 
<i>S</i><sub>0</sub>, <i>S</i><sub>1</sub>, ... , 
<i>S</i><sub>2<i>r</i>+1</sub> koje ovise o klju&#269;u <i>K</i>. 
Najprije se klju&#269; 
<i>K</i><sub>0</sub>...<i>K</i><sub><i>b</i>-1</sub> od <i>b</i> 
bajtova prebaci u 
niz od <i>c</i> rije&#269;i 
<i>M</i><sub>0</sub>...<i>M</i><sub><i>c</i>-1</sub> 
(ako <i>b</i> nije vi&#353;ekratnik od <i>w</i>, onda se dodaju nule). 
Zatim se <i>S<sub>i</sub></i>-ovi inicijaliziraju koriste&#263;i 
pseudoslu&#269;ajne veli&#269;ine 
<p align=center>
<i>P<sub>w</sub></i> = Odd [(e - 2) 2<sup><i>w</i></sup>], &nbsp; &nbsp; 
<i>Q<sub>w</sub></i> = Odd 
[(&phi; - 1) 
2<sup><i>w</i></sup>], 
</p>
gdje je <i>e</i> baza prirodnog logaritma, 
&phi; = 
(1 + &radic;5)/2 
omjer zlatnog reza, a funkcija Odd zaokru&#382;ivanje na najbli&#382;i neparni 
broj. Za <i>w</i> = 32 je <i>P<sub>w</sub></i> = B7E15163, 
<i>Q<sub>w</sub></i> = 9E3779B9. 
<p>
Inicijalizacija: &nbsp; <i>S</i><sub0</sub> = <i>P<sub>w</sub></i>, 
<i>S<sub>i</sub></i> = <i>S</i><sub><i>i</i>-1</sub> + 
<i>Q<sub>w</sub></i>, <i>i</i> = 1, 2, ... , 2<i>r</i>+1. <br>
Procedura: <br>

&nbsp; &nbsp; &nbsp; <i>i</i> = <i>j</i> = <i>X</i> = <i>Y</i> = 0, 
<i>n</i> = 3 max (2<i>r</i>+2, c) <br>
&nbsp; &nbsp; &nbsp; <u>do</u> 3<i>n</i> <u>times</u> <br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <i>S<sub>i</sub></i> = 
(<i>S<sub>i</sub></i> + <i>X</i> + <i>Y</i>) <<< 3, 
<i>X</i> = <i>S<sub>i</sub></i>, <i>i</i> = <i>i</i> + 1 
(mod 2<i>r</i>+2), <br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <i>M<sub>j</sub></i> = 
(<i>M<sub>j</sub></i> + <i>X</i> + <i>Y</i>) <<< (<i>X</i> + <i>Y</i>), 
<i>Y</i> = <i>M<sub>j</sub></i>, <i>j</i> = <i>j</i> + 1 
(mod <i>c</i>). 
<p>

Kod &#353;ifriranja, najprije podijelimo blok otvorenog teksta na dvije 
<i>w</i>-bitne rije&#269;i <i>A</i> i <i>B</i>. Zatim se primjeni algoritam: 
<p>
&nbsp; &nbsp; &nbsp; <i>L</i><sub>0</sub> = <i>A</i> + <i>S</i><sub>0</sub>, 
<i>R</i><sub>0</sub> = <i>B</i> + <i>S</i><sub>1</sub>, <br>
&nbsp; &nbsp; &nbsp; <u>for</u> <i>i</i> = 1 <u>to</u> <i>r</i> <u>do</u> <br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <i>L<sub>i</sub></i> = 
((<i>L</i><sub><i>i</i>-1</sub> 
&oplus;  
<i>R</i><sub><i>i</i>-1</sub>) <<< <i>R</i><sub><i>i</i>-1</sub>) + 
<i>S</i><sub>2<i>i</i></sub>  <br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <i>R<sub>i</sub></i> = 
((<i>R</i><sub><i>i</i>-1</sub> 
&oplus;  
<i>L</i><sub><i>i</i></sub>) <<< <i>L</i><sub><i>i</i>-1</sub>) + 
<i>S</i><sub>2<i>i</i>+1</sub>.

<p align=center>
<img src="slike/RC5a.gif" alt="RC5">
</p>

Primijetimo da se u svakoj rundi mijenjaju obje polovice podatka. 
Stoga se jedna runda RC5 mo&#382;e na neki na&#269;in smatrati ekvivalentom 
za dvije runde DES-a. To donekle obja&#353;njava za&#353;to RC5 s 12 rundi posti&#382;e
sli&#269;ne efekte za koje je 3DES-u potrebno &#269;ak 48 rundi.

<p>

Naziv RC5 sugerira da je to jedan iz niza kriptosustava (RC dolazi od &quot;Rivest Cipher&quot;).
Zaista, postoje RC2, RC4 i RC6 kripotsustavi (RC1 i RC3 su bile radne verzije).
Dok su RC2 i RC6 sli&#269;ni RC5, kriptosustav RC4 je druk&#269;ijeg tipa i predstavlja
jednu od najpoznatijih proto&#269;nih &#353;ifri.

<p>

<hr size=2 noshade>

<b><font size="-1" face="Verdana">
<a href="desan.html">[Prethodno poglavlje]</a> &nbsp; 
<a href="aes.html">[Sljede&#263;e poglavlje]</a> &nbsp;
<a href="kriptografija.html">[Sadr&#382;aj]</a>
</font></b>

<hr size=2 noshade>


<table border="0" width="100%">
<tr valign="bottom">
<td>
<a href="../kript.html">Web stranica kolegija <em>Kriptografija</em></a>
</td>

<td align="right">
<a href="../index.html"><em>Andrej Dujella</em> - osobna stranica</a>
</td>
</tr>
</table>

<!-- Start eXTReMe Non Public Tracker Code V3/5
Login:    duje
Help:     https://www.extremetracking.com -->
<script type="text/javascript"><!--
EXs=screen;EXw=EXs.width;navigator.appName!="Netscape"?
EXb=EXs.colorDepth:EXb=EXs.pixelDepth;
navigator.javaEnabled()==1?EXjv="y":EXjv="n";
EXd=document;EXw?"":EXw="na";EXb?"":EXb="na";
location.protocol=="https:"?EXprot="https":EXprot="http";
top.document.referrer?EXref=top.document.referrer:EXref=EXd.referrer;
EXd.write("<img src="+EXprot+"://nht-2.extreme-dm.com",
"/n2.g?login=duje&amp;url="+escape(document.URL)+"&amp;pv=&amp;",
"jv="+EXjv+"&amp;j=y&amp;srw="+EXw+"&amp;srb="+EXb+"&amp;",
"l="+escape(EXref)+" height=1 width=1>");//-->
</script><noscript><div id="nneXTReMe"><img height="1" width="1" alt=""
src="http://nht-2.extreme-dm.com/n2.g?login=duje&amp;url=nojs&amp;j=n&amp;jv=n&amp;pv=" />
</div></noscript>
<!-- End eXTReMe Non Public Tracker Code -->

</body>
</html>



