
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Vigenereova šifra</title>

<meta name="author" content="Andrej Dujella">
<meta name="description" content="Kriptografija - Vigenereova sifra">
<meta name="keywords" content="Vigenere, kriptoanaliza, 
indeks koincidencije">

<meta http-equiv="Content-Type" content="text/html; charset=windows-1250">

<meta name="viewport" content="width=device-width, initial-scale=0.6">

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

<style type="text/css">
body {font-family: Arial,Helvetica,sans-serif;}
</style>

</head>

<body bgcolor="#FFFFFF">

<b><font size="-1" face="Verdana">
<a href="supst.html">[Prethodno poglavlje]</a> &nbsp; 
<a href="playfair.html">[Sljedeæe poglavlje]</a> &nbsp; 
<a href="kriptografija.html">[Sadržaj]</a>
</font></b>
<p>

<hr size=2 noshade>

<a name="1.3"></a>
<h2 align=center style="color: rgb(128,0,0)">1.3. Vigen&egrave;reova 
šifra</h2>


Kod supstitucijske šifre svakom slovu otvorenog teksta odgovara 
jedinstveno slovo šifrata. Takve šifre se zovu 
<em>monoalfabetske</em>. Prikazat æemo sada Vigen&egrave;reovu šifru 
koja spada u <em>polialfabetske kriptosustave</em>. Naime, kod nje 
svako slovo otvorenog teksta može se preslikati u jedno od <i>m</i> 
moguæih slova (gdje je <i>m</i> duljina kljuèa), u ovisnosti o svom 
položaju unutar otvorenog teksta. 
<p>
Francuski diplomat <font color=009900>Blaise de Vigen&egrave;re</font> je 1586. godine 
objavio knjigu "Traicte de Chiffres" u kojoj se 
nalazilo sve što se u to vrijeme znalo o kriptografiji 
(ali gotovo ništa o kriptoanalizi). U njoj je opisano više 
originalnih polialfabetskih sustava. Sustav koji se danas naziva 
Vigen&egrave;reova šifra definiran je na sljedeæi naèin. 
<p>

<table align=center border=1 width="95%" cellpadding=15> 
<tr><td bgcolor="FFFFCC">
<font face="Arial,Helvetica,sans-serif">

Neka je <i>m</i> fiksan prirodan broj. Definiramo 
<font face="Brush Script MT,Script,Times New Roman">P</font> = 
<font face="Brush Script MT,Script,Times New Roman">C</font> = 
<font face="Brush Script MT,Script,Times New Roman">K</font> = 
(<b>Z</b><sub>26</sub>)<sup><i>m</i></sup>. 
Za kljuè <i>K</i> = (<i>k</i><sub>1</sub>, <i>k</i><sub>2</sub>, 
... , <i>k</i><sub><i>m</i></sub>), definiramo 
<p align=center>
<i>e<sub>K</sub></i>(<i>x</i><sub>1</sub>, <i>x</i><sub>2</sub>, ... , 
<i>x</i><sub><i>m</i></sub>) = (<i>x</i><sub>1</sub> +<sub>26</sub> <i>k</i><sub>1</sub>, 
<i>x</i><sub>2</sub> +<sub>26</sub> <i>k</i><sub>2</sub>, ... , 
<i>x</i><sub><i>m</i></sub> +<sub>26</sub> <i>k</i><sub><i>m</i></sub>), <br>

<i>d<sub>K</sub></i>(<i>y</i><sub>1</sub>, <i>y</i><sub>2</sub>, ... , 
<i>y</i><sub><i>m</i></sub>) = (<i>y</i><sub>1</sub> -<sub>26</sub> <i>k</i><sub>1</sub>, 
<i>y</i><sub>2</sub> -<sub>26</sub> <i>k</i><sub>2</sub>, ... , 
<i>y</i><sub><i>m</i></sub> -<sub>26</sub> <i>k</i><sub><i>m</i></sub>). 
</p>
</font></td></tr></table>
<p><br><br>

Dakle, slova otvorenog teksta pomièemo za <i>k</i><sub>1</sub>, <i>k</i><sub>2</sub>, ... 
ili <i>k</i><sub><i>m</i></sub> mjesta, u ovisnosti o tome na kojem se mjestu u 
otvorenom tekstu nalaze (preciznije, pomak ovisi o ostatku koji dobijemo kada poziciju slova 
podijelimo s duljinom kljuèa <i>m</i>). Kod ove su šifre 
osnovni elementi otvorenog teksta i šifrata "blokovi" od po <i>m</i> slova. 
No, šifriranje se zapravo provodi "slovo po slovo", pa ovdje nije 
nužno nadopuniti zadnji blok ako broj slova u otvorenom tekstu nije djeljiv s <i>m</i>. 
<p>

<b>Primjer 1.5: </b> Neka je <i>m</i> = 4 i kljuèna 
rijeè &nbsp; 
<font color=990099>BROJ</font></tt>. 
Njezin numerièki ekvivalent je kljuè  
<i>K</i> = (1, 17, 14, 9). 
Pretpostavimo da je otvoreni tekst &nbsp; 
<font color=990000>KRIPTOLOGIJA</font>. 
Šifriranje se provodi na sljedeæi naèin: 

<pre><font size=2>
        10  17   8  15      19  14  11  14       6   8   9   0 
    
         1  17  14   9       1  17  14   9       1  17  14   9     
  +<sub>26</sub>  _________________________________________________________

        11   8  22  24      20   5  25  23       7  25  23   9

</font></pre>
Dakle, šifrat je &nbsp;  
<font color=000099>LIWYUFZXHZXJ</font>. Rezultat se može provjeriti i <a href="vigjs.html">OVDJE</a>.  
Uoèimo da se prvo 
slovo O preslikalo u F, a drugo u X.
<p>

Primjer 1.5 može se ilustrirati i ovako 
<pre><font size=3>    kljuè         <font color=990099>B R O J B R O J B R O J</font> 
otvoreni tekst    <font color=990000>K R I P T O L O G I J A</font> 
    šifrat        <font color=000099>L I W Y U F Z X H Z X J</font>
</font></pre>
Vidimo da se ovdje kljuè ponavlja u nedogled pa prema podjeli šifara, 
s obzirom na naèin na koji se obraðuje otvoreni tekst, ovu šifru možemo 
shvatiti kao primjer blokovne šifre. Postoje i druge 
varijante Vigen&egrave;reove šifre. Jedna takva (sigurnija od originalne) 
je ona s <em>autokljuèem</em> (engl. autokey), u kojoj otvoreni tekst generira kljuè. 
naime, originalni kljuè se koristi samo za šifriranje prvog bloka 
od <i>m</i> slova, dok se za šifriranje daljnjih blokova koristi 
prethodni blok otvorenog teksta. Time ova varijanta spada u protoène šifre. 
<p>

<b>Primjer 1.6: </b> <em>Sve isto kao u Primjeru 1.5, ali s 
autokljuèem</em>. 
<p>
U šifriranju æemo koristiti tzv. 
<a href="tablice/vigkva.html" target="_blank">Vigen&egrave;reov kvadrat</a> 
Ako npr. slovo K treba šifrirati 
kljuèem B, onda pogledamo stupac koji poèinje s K i redak koji poèinje 
s B. U presjeku je šifrat L. Dobivamo: 
<pre><font size=3>    kljuè         <font color=990099>B R O J K R I P T O L O</font> 
otvoreni tekst    <font color=990000>K R I P T O L O G I J A</font> 
    šifrat        <font color=000099>L I W Y D F T D Z W U O</font>
</font></pre>
<p>

Vigen&egrave;reova šifra je jedan od najpopularnijih kriptosustava u 
povijesti. Spomenimo da je bila u širokoj uporabi tijekom Amerièke revolucije, 
krajem 18. stoljeæa, a korištena je i u Amerièkom graðanskom ratu. 
Èak je 1917. u uglednom èasopisu 
"Scientific American" objavljeno da je ovu šifru "nemoguæe razbiti". 
To naravno nije bilo toèno, jer su kriptoanalitièari veæ pola stoljeæa 
prije toga poznavali metode za napad na Vigen&egrave;reovu šifru. 
<p>
Recimo sada nešto o kriptoanalizi Vigen&egrave;reove šifre. 
Prvi korak je odreðivanje duljine kljuène rijeèi. 
Prikazat æemo dvije metode. Prva metoda se zove <em>Kasiskijev 
test</em> i uveo ju je 
<font color=009900>Friedrich Kasiski</font> 1863. godine, 
a koristio ju je otprilike u isto vrijeme i <font color=009900>Charles Babbage</font>. 
Metoda se 
zasniva na èinjenici da æe dva identièna segmenta otvorenog teksta 
biti šifrirana na isti naèin ukoliko se njihove poèetne pozicije 
razlikuju za neki višekratnik od <i>m</i>, gdje je <i>m</i> duljina kljuèa. 
Obrnuto, ako 
uoèimo dva identièna segmenta u šifratu, duljine barem 3, tada 
je vrlo vjerojatno da oni odgovaraju identiènim segmentima otvorenog 
teksta (podudarnost odsjeèaka duljine 2 lako može biti i sluèajna, 
dok je kod odsjeèaka veæe duljine to puno manje vjerojatno). 
<p>
U Kasiskijevom testu u šifrati tražimo parove identiènih segmenata 
duljine barem 3, te (ako takvi postoje) zabilježimo udaljenosti izmeðu njihovih poèetnih 
položaja. Ako na takav naèin dobijemo udaljenosti 
<i>d</i><sub>1</sub>, <i>d</i><sub>2</sub>, ... , onda je 
razumna pretpostavka da <i>m</i> dijeli veæinu 
<i>d<sub>i</sub></i>-ova. Nakon što odredimo <i>m</i>, nalazimo se u 
sliènoj situaciji kao kod Cezarove šifre. 
Naime, ako pogledamo samo ona slova koja su šifrirana pomakom za <i>k</i><sub>1</sub> 
slova (a ako znamo <i>m</i>, onda znamo i koja su to slova), onda su ona 
šifrirana obiènom Cezarovom šifrom. Situacija je ipak nešto teža nego kod obiène 
Cezarove šifre, zbog toga što to ovdje 
nisu uzastopna slova u otvorenom tekstu, pa njihovim dešifriranjem neæemo dobiti 
smisleni tekst. Zato æemo opisati još jednu metodu za razbijanje Vigen&egrave;reove šifre.
<p>

Druga metoda za odreðivanje duljine kljuèa koristi tzv. 
indeks koincidencije. Taj je pojam uveo 1920. godine 
<font color=009900>William Friedman</font> u knjizi 
"Indeks koincidencije i njegove 
primjene u kriptografiji", koja se smatra jednom od 
najvažnijih publikacija u povijesti kriptologije. 
<p>

<table align=center border=1 width="95%" cellpadding=15> 
<tr><td bgcolor="FFFFCC">
<font face="Arial,Helvetica,sans-serif">

<b>Definicija 1.2: </b> Neka je <i>x</i> = 
<i>x</i><sub>1</sub><i>x</i><sub>2</sub> ... 
<i>x</i><sub><i>n</i></sub> 
niz od <i>n</i> slova. <em>Indeks koincidencije</em> od <i>x</i>, 
u oznaci I<sub>c</sub>(<i>x</i>), se definira kao vjerojatnost 
da su dva sluèajna elementa iz <i>x</i> jednaka. 
<p>
Neka su <i>f</i><sub>0</sub>, <i>f</i><sub>1</sub>, ... , 
<i>f</i><sub>25</sub> redom (apsolutne) frekvencije od A, B, 
C, ... , Z u <i>x</i>. Dva elementa iz <i>x</i> možemo odabrati na 
<nobr><i>n</i>(<i>n</i>-1)/2</nobr> naèina, a za svaki <i>i</i> = 
0, 1, ... , 25 postoji <nobr><i>f</i><sub><i>i</i></sub>
(<i>f</i><sub><i>i</i></sub>-1)/2</nobr> naèina odabira dvaput 
<i>i</i>-tog slova. Stoga vrijedi formula
<p align=center>
I<sub>c</sub>(<i>x</i>) = &sum;<sub><i>i</i></sub>&nbsp   
<i>f</i><sub><i>i</i></sub>(<i>f</i><sub><i>i</i></sub>-1) / 
<i>n</i>(<i>n</i>-1).
</p>
</font></td></tr></table>
<p>

Pretpostavimo sada da <i>x</i> predstavlja neki tekst na hrvatskom  
jeziku. Oznaèimo oèekivane vjerojatnosti pojavljivanja slova 
A, B, ... , Z u hrvatskom jeziku redom s <i>p</i><sub>0</sub>, <i>p</i><sub>1</sub>, 
... , <i>p</i><sub>25</sub> (vidi ranije navedene 
<a href="supst.html#frek">frekvencije slova</a> u promilima). 
Ako je <i>n</i> dovoljno velik, za oèekivati je da æe vrijediti 

<p align=center>
I<sub>c</sub>(<i>x</i>) &asymp; &sum;<sub><i>i</i></sub>&nbsp  
<i>p</i><sub><i>i</i></sub><sup>2</sup> &asymp; 0.064 
</p>
(vjerojatnost da su oba slova A je <i>p</i><sub>0</sub><sup>2</sup> &asymp; 
0.115<sup>2</sup>, 
da su oba B je <i>p</i><sub>1</sub><sup>2</sup> &asymp; 0.015<sup>2</sup>, itd.). 
Isti zakljuèak vrijedi i ukoliko je <i>x</i> šifrat dobiven iz 
otvorenog teksta na hrvatskom jeziku pomoæu neke monoalfabetske 
šifre. Tu æe se pojedinaène vjerojatnosti ispremještati, 
ali æe velièina 
<nobr>&sum;<sub><i>i</i></sub>&nbsp 
<i>p</i><sub><i>i</i></sub><sup>2</sup></nobr>
ostati nepromijenjena.  
<p>
Pretpostavimo sada da imamo šifrat <nobr><i>y</i> = 
<i>y</i><sub>1</sub><i>y</i><sub>2</sub> ... 
<i>y</i><sub><i>n</i></sub></nobr> 
koji je dobiven Vigen&egrave;reovom šifrom. Rastavimo <i>y</i> na 
<i>m</i> podnizova <nobr><i>z</i><sub>1</sub>, <i>z</i><sub>2</sub>, ... , 
<i>z</i><sub><i>m</i></sub></nobr> tako da <i>y</i> napišemo, 
po stupcima, u matricu dimenzija <i>m</i> 
&times; (<i>n</i>/<i>m</i>). (Ako <i>m</i> ne dijeli <i>n</i>, možemo 
nadopuniti <i>y</i> na prozvoljan naèin ili promatrati "krnju matricu" 
s nepotpunim zadnjim stupcem.)   
Redci ove matrice su upravo traženi podnizovi 
<nobr><i>z</i><sub>1</sub>, <i>z</i><sub>2</sub>, ... , 
<i>z</i><sub><i>m</i></sub>.</nobr>  
Ako je <i>m</i> jednak duljini kljuène rijeèi, 
onda su elementi istog retka matrice šifrirani pomoæu istog slova kljuèa. 
Na primjer, prvi redak sadrži prvo, <nobr>(<i>m</i>+1)-vo,</nobr> 
<nobr>(2<i>m</i>+1)-vo,</nobr> ... slovo šifrata, a sva su ta slova šifrirana 
pomoæu <i>k</i><sub>1</sub>. 
Zato bi svi indeksi koincidencije  
I<sub>c</sub>(<i>z</i><sub><i>i</i></sub>) trebali biti 
približno jednaki 0.064. S druge strane, ako <i>m</i> nije duljina 
kljuène rijeèi, onda æe <i>z</i><sub><i>i</i></sub>-ovi izgledati 
više-manje sluèajni nizovi slova, buduæi su dobiveni pomacima pomoæu razlièitih 
slova kljuèa. Primijetimo da za potpuno sluèajni niz imamo
<p align=center>
I<sub>c</sub> &asymp; 26 
<b>&middot;</b> (1/26)<sup>2</sup> 
= 1/26 &asymp; 0.038. 
</p>
Ove dvije vrijednosti 
<nobr>&kappa;<sub>p</sub> = 0.064</nobr> i 
<nobr>&kappa;<sub>r</sub> = 0.038</nobr>  
(p = plaintext, r = random) 
su dovoljno daleko jedna od druge, tako da æemo najèešæe na 
ovaj naèin moæi odrediti toènu duljinu kljuène rijeèi (ili 
potvrditi pretpostavku dobivenu pomoæu Kasiskijeve metode). 
Spomenimo da je u engleskom jeziku 
<nobr>&kappa;<sub>p</sub> = 0.065,</nobr>  
u njemaèkom 0.076, u francuskom 0.078, u talijanskom 0.074, 
a u španjolskom 0.078. Odavde zakljuèujemo da za primjenu ove metode nije nužno 
znati na kojem je jeziku pisan otvoreni tekst. Jedina bitna pretpostavka 
jest da se za jezik na kojem je pisan otvoreni tekst velièina &kappa;<sub>p</sub> 
znaèajno razlikuje od 0.038.  
<p>

<b>Primjer 1.7: </b> <em>Dekriptirati šifrat dobiven Vigen&egrave;reovom šifrom:</em> 
<pre><font size=4>
      GSIQITUKQIEAOHRVUGLTAZGHXUHLPJMRTTNQRBZIAVBTG
      QTBY<font size=4 color=CC3333>MYA</font>IVO<font size=4 color=FFCC66>MZT</font>AIXJBT<font size=4 color=CC33CC>EDE</font>WVQWADVWGOOKNQNTCIPEGPY
      BOKUSECNWELLCPZUM<font size=4 color=336699>I<u>VW</font>F</u>UIJ<font size=4 color=CC3333>MYA</font>TUEXISL<font size=4 color=FFCC66>MZT</font>NPGUJHTM
      ERXJSYS<font size=4 color=336699>IVW</font>ABG<u>VWF</u>DTZILNTI<font size=4 color=CC33CC>EDE</font>FJMFAMPNQZBRSDIZPR
      MLGVKFEDZXMVXVQMJXWSLEEQRMAEPRUJXIMFNT
</font></pre>
Primijenimo najprije Kasiskijev test. Uoèavamo pojavu 
nekoliko trigrama koji se dvaput pojavljuju u šifratu. 
To su
<font color=CC3333>MYA</font> s poèetkom na pozicijama 50 i 115 
(115 - 50 = 65 = 5 <b>&middot;</b> 13),
<font color=FFCC66>MZT</font> s poèetkom na pozicijama 56 i 125 
(125 - 56 = 69 = 3 <b>&middot;</b> 23),
<font color=CC33CC>EDE</font> (160 - 65 = 95 =
5 <b>&middot;</b> 19),
<font color=336699>IVW</font> (143 - 108 = 35 =
5 <b>&middot;</b> 7),
i <u>VWF</u> (149 - 109 = 40 =
5 <b>&middot;</b> 8).
Odavde se kao najvjerojatnija duljina kljuène rijeèi
nameæe broj <i>m</i> = 5, koji dijeli sve osim jedne od razlika
poèetnih pozicija ponovljenih trigrama.
<p>

Pogledajmo hoæemo li pomoæu indeksa koincidencije doæi do
istog zakljuèka. Za <i>m</i> = 1 je I<sub>c</sub> = 0.040;
za <i>m</i> = 2 su indeksi 0.037 i 0.040; za <i>m</i> = 3
su 0.038, 0.048 i 0.038; za <i>m</i> = 4 su 0.036, 0.038,
0.044 i 0.036, dok za <i>m</i> = 5 dobivamo indekse
0.057, 0.052, 0.066, 0.076 i 0.066. Sada veæ s prilièno
velikom sigurnošæu možemo zakljuèiti da je duljina kljuène rijeèi
jednaka 5.
<p>
Sljedeæe je pitanje kako odrediti kljuènu rijeè ukoliko znamo
njezinu duljinu. Tu nam može pomoæi <em>meðusobni indeks
koincidencije dvaju nizova</em>.

<p>
<table align=center border=0 width=95% cellpadding=15> 
<tr><td bgcolor="FFFFCC">
<font size=+0 face=Arial,Helvetica,sans-serif>

<b>Definicija 1.3: </b> Neka su <nobr><i>x</i> = 
<i>x</i><sub>1</sub><i>x</i><sub>2</sub> ... <i>x</i><sub><i>n</i></sub></nobr> i <nobr><i>y</i> = 
<i>y</i><sub>1</sub><i>y</i><sub>2</sub> ... <i>y</i><sub><i>n'</i></sub></nobr> dva niza od <i>n</i>, odnosno 
<i>n'</i> slova. <em>Meðusobni indeks koincidencije</em> 
od <i>x</i> i <i>y</i>, u oznaci <nobr>MI<sub>c</sub>(<i>x</i>,<i>y</i>),</nobr>  
se definira kao vjerojatnost da je sluèajni element od <i>x</i> 
jednak sluèajnom elementu od <i>y</i>. Ako frekvencije od 
A, B, C, ... , Z u <i>x</i> i <i>y</i> oznaèimo sa 
<i>f</i><sub>0</sub>, <i>f</i><sub>1</sub>, ... , 
<i>f</i><sub>25</sub>, odnosno 
<i>f'</i><sub>0</sub>, <i>f'</i><sub>1</sub>, ... , 
<i>f'</i><sub>25</sub>, onda je 
<p align=center>
MI<sub>c</sub> = 
&sum;<sub><i>i</i></sub>&nbsp   
<i>f</i><sub><i>i</i></sub><i>f'</i><sub><i>i</i></sub> / 
<i>n</i><i>n'</i>. 
</p>
</font></td></tr></table>
<p>

Neka je sada <i>m</i> duljina kljuène rijeèi, te neka su podnizovi 
<nobr><i>z</i><sub>1</sub>, <i>z</i><sub>2</sub>, ... , 
<i>z</i><sub><i>m</i></sub></nobr> dobiveni kao prije.
<p>
Pretpostavimo da je <nobr><i>K</i> = 
(<i>k</i><sub>1</sub>, <i>k</i><sub>2</sub>, ... , 
<i>k</i><sub><i>m</i></sub>)</nobr> kljuèna rijeè, te pokušajmo ocijeniti indeks 
<nobr>MI<sub>c</sub>(<i>z</i><sub>i</sub>,<i>z</i><sub>j</sub>).</nobr>  
Promotrimo proizvoljno slovo u <i>z</i><sub><i>i</i></sub> 
i proizvoljno slovo u <i>z</i><sub>j</sub>. 
Procijenimo vjerojatnost da su oba slova jednaka A. 
Vjerojatnost da pomakom za <i>k</i><sub><i>i</i></sub> dobijemo slovo A 
približno je jednaka vjerojatnosti s kojom se u hrvatskom jeziku 
pojavljuje slovo èiji je numerièki ekvivalent 
<nobr>-<i>k</i><sub><i>i</i></sub> mod 26.</nobr> 
Dakle, vjerojatnost, da su oba ova slova jednaka A, približno je jednaka 
<TABLE align=center CELLSPACING=0 CELLPADDING=0><TR><TD><I>p</I></TD><TD><TABLE 
CELLSPACING=0 
CELLPADDING=0><TR><TD>&nbsp</TD></TR><TR><TD>-<I>k</I><SUB><FONT 
SIZE=-1><I>i</I></FONT></SUB></TD></TR></TABLE></TD>
<TD><I>p</I></TD>
<TD><TABLE 
CELLSPACING=0 
CELLPADDING=0><TR><TD>&nbsp</TD></TR><TR><TD>-<I>k</I><SUB><FONT 
SIZE=-1><I>j</I></FONT></SUB></TD></TR></TABLE></TD><TD>,</TD>
</TR></TABLE>
da su oba slova B, približno je jednaka  
<TABLE align=center CELLSPACING=0 CELLPADDING=0><TR><TD><I>p</I></TD><TD><TABLE 
CELLSPACING=0 
CELLPADDING=0><TR><TD>&nbsp</TD></TR><TR><TD>1-<I>k</I><SUB><FONT 
SIZE=-1><I>i</I></FONT></SUB></TD></TR></TABLE></TD>
<TD><I>p</I></TD>
<TD><TABLE 
CELLSPACING=0 
CELLPADDING=0><TR><TD>&nbsp</TD></TR><TR><TD>1-<I>k</I><SUB><FONT 
SIZE=-1><I>j</I></FONT></SUB></TD></TR></TABLE></TD><TD>,</TD>
</TR></TABLE>
itd. (operacije u indeksima su modulo 26). Dakle, imamo ocjenu 

<p align=center>
MI<sub>c</sub>(<i>z</i><sub><i>i</i></sub>, 
<i>z</i><sub><i>j</i></sub>) 
&asymp;  
&sum;<sub><i>h</i></sub>&nbsp 
<i>p<sub>h-k<sub>i</sub></sub></i> <i>p<sub>h-k<sub>j</sub></sub></i> = 
&sum;<sub><i>h</i></sub>&nbsp 
<i>p<sub>h</sub></i> <i>p<sub>h+k<sub>i</sub>-k<sub>j</sub></sub></i> </p>
(pomakom indeksa suma se ne mijenja).  
Uoèimo da ova ocjena ovisi samo o razlici 
<nobr>(<i>k<sub>i</sub> - k<sub>j</sub></i>) mod 26,</nobr> 
koju æemo zvati relativni pomak od 
<i>z</i><sub><i>i</i></sub> i <i>z</i><sub><i>j</i></sub>. 
Takoðer, vrijedi  
<nobr>&sum;<sub><i>h</i></sub>&nbsp 
<i>p<sub>h</sub></i> <i>p<sub>h+q</sub></i> = 
&sum;<sub><i>h</i></sub>&nbsp 
<i>p<sub>h</sub></i> <i>p<sub>h-q</sub></i>,</nobr>  
što znaèi da za pomak <i>q</i> dobivamo istu ocjenu kao i za 
pomak <nobr>26 - <i>q</i>.</nobr> Stoga je dovoljno promatrati 
pomake izmeðu 0 i 13. To je i napravljeno u sljedeæoj tablici 
<pre><font size=3>
________________________________________________________

 relativni pomak            oèekivana vrijednost od MI<sub>c</sub> 
________________________________________________________

        0                             0.064  
        1                             0.039 
        2                             0.031 
        3                             0.031  
        4                             0.044
        5                             0.040
        6                             0.039  
        7                             0.033 
        8                             0.040
        9                             0.042
       10                             0.036  
       11                             0.036  
       12                             0.036 
       13                             0.039 
________________________________________________________

</font></pre>
Važno je uoèiti da ako je pomak jednak 0, onda je ocjena 
0.064, a ako je pomak razlièit od 0, onda su ocjene 
izmeðu 0.031 i 0.044, dakle, bitno manje. Ovo zapažanje 
se može iskoristiti za odreðivanje vrijednosti 
<nobr><i>q</i> = <i>k<sub>i</sub> - k<sub>j</sub></i>.</nobr> 
<p>
Pretpostavimo da smo fiksirali <i>z</i><sub><i>i</i></sub> 
i promotrimo efekt šifriranja <i>z</i><sub><i>j</i></sub> 
sa slovima A, B, C, ... , Z (tj. pomakom za 0, 1, 2, ... , 25 mjesta). 
Tako dobivene nizove oznaèimo sa 
<nobr><i>z</i><sub><i>j</i></sub><sup>0</sup>, 
<i>z</i><sub><i>j</i></sub><sup>1</sup>, ... .</nobr> 
Za <i>g</i> = 0,1,...,25 izraèunamo indeks 
<nobr>MI<sub>c</sub>(<i>z</i><sub><i>i</i></sub>, 
<i>z</i><sub><i>j</i></sub><sup><i>g</i></sup>)</nobr> 
po formuli 
<p align=center>
MI<sub>c</sub>(<i>x</i>, <i>y</i><sup>g</sup>) = 
&sum;<sub><i>i</i></sub>&nbsp   
<i>f</i><sub><i>i</i></sub><i>f'</i><sub><i>i-g</i></sub> / 
<i>n</i><i>n'</i>. 
</p>
Za <i>g</i> &equiv; <i>q</i> (mod 26), MI<sub>c</sub> bi trebao biti blizu 
0.064, a za <nobr><i>g</i> &#8802;  
<i>q</i> (mod 26)</nobr> bi trebao uglavnom varirati izmeðu 0.031 i 0.044. 
<p>
Na ovaj naèin, možemo utvrditi relativne pomake bilo koja dva podniza 
<i>z</i><sub><i>i</i></sub> i <i>z</i><sub><i>j</i></sub>. 
Nakon što to uèinimo, ostaje nam samo 26 moguæih kljuènih rijeèi 
koje onda možemo ispitati jednu po jednu.
<p>
No, malom modifikacijom ove metode, do kljuène rijeèi možemo doæi 
efikasnije, ukoliko nam je poznato na kojem je jeziku 
pisan otvoreni tekst. Umjesto meðusobnog indeksa koincidencije nizova   
<i>z</i><sub><i>i</i></sub> i <i>z</i><sub><i>j</i></sub><sup><i>g</i></sup>, 
raèunat æemo <nobr>MI<sub>c</sub>(<i>x</i>, 
<i>z</i><sub><i>j</i></sub><sup><i>g</i></sup>),</nobr> gdje je <i>x</i> niz koji 
odgovara tipiènom tekstu na jeziku otvorenog teksta. 
Pretpostavimo da nam je poznato (ili da to barem nasluæujemo) da je 
otvoreni tekst pisan na hrvatskom jeziku. 
To znaèi da su relativne 
frekvencije <nobr><i>f<sub>i</sub></i> / <i>n</i></nobr> 
približno jednake <i>p<sub>i</sub></i>, pa je   
<p align=center>
MI<sub>c</sub>(<i>x</i>, <i>z</i><sub><i>j</i></sub><sup><i>g</i></sup>) 
&asymp;  
&sum;<sub><i>i</i></sub>&nbsp   
<i>p</i><sub><i>i</i> </sub><i>f'</i><sub><i>i-g</i></sub> / 
<i>n'</i>. 
</p>
Oèekujemo da je MI<sub>c</sub>(<i>x</i>, <i>z</i><sub><i>j</i></sub><sup><i>g</i></sup>) 
&asymp; 0.064 ako je <i>g</i> &equiv;  
-<i>k<sub>j</sub></i> (mod 26), a u protivnom da je 
MI<sub>c</sub>(<i>x</i>, <i>z</i><sub><i>j</i></sub><sup><i>g</i></sup>) < 0.045.
<p>
Prema tome, da bismo odredili <i>j</i>-to slovo <i>k<sub>j</sub></i> kljuène rijeèi, 
postupamo da sljedeæi naèin. Za 
<nobr>0 &le; <i>g</i> &le; 25</nobr> izraèunamo 
<p align=center>
<i>M<sub>g</sub></i> =   
&sum;<sub><i>i</i></sub>&nbsp   
<i>p</i><sub><i>i</i> </sub><i>f'</i><sub><i>i-g</i></sub> / 
<i>n'</i>. 
</p>
Odredimo <i>h</i> takav da je 
<i>M<sub>h</sub></i> = max { <i>M<sub>g</sub></i> : 
0 &le; <i>g</i> &le; 25 }, te stavimo 
<i>k<sub>j</sub></i> &equiv; -h (mod 26). 
<p>  
  

<b>Nastavak primjera 1.7: </b> Veæ smo zakljuèili da je <i>m</i> = 5. 
Za <i>j</i> = 1,2,3,4,5 izraèunajmo vrijednosti <i>M</i><sub>0</sub>, 
<i>M</i><sub>1</sub>, ... , <i>M</i><sub>25</sub>. Npr. za <i>j</i> = 1 je 
<p align=center>
<i>M</i><sub>0</sub> = (0.115 <b>&middot;</b> 3 + 0.015 <b>&middot;</b> 1 + 
0.028 <b>&middot;</b> 0 + ... + 0.023 <b>&middot;</b> 1)/44 &asymp; 0.0310.
</p>
Sve tražene vrijednosti nalaze se u sljedeæoj 
<a href="tablice/coincid3.html" target="_blank">tablici</a>. 
<p>
Iz tablice išèitavamo redom:
<ul>
<li>Za <i>j</i> = 1 imamo <i>h</i> = 14, <i>M</i><sub>14</sub> = 0.0636, 
pa je <i>k</i><sub>1</sub> = -14 mod 26 = 26- 14 = 12;  
<li>Za <i>j</i> = 2 imamo <i>h</i> = 0, <i>M</i><sub>0</sub> = 0.0616, 
pa je <i>k</i><sub>2</sub> = 0;  
<li>Za <i>j</i> = 3 imamo <i>h</i> = 7, <i>M</i><sub>7</sub> = 0.0650, 
pa je <i>k</i><sub>3</sub> = 19;  
<li>Za <i>j</i> = 4 imamo <i>h</i> = 19, <i>M</i><sub>19</sub> = 0.0643, 
pa je <i>k</i><sub>4</sub> = 7;  
<li>Za <i>j</i> = 5 imamo <i>h</i> = 22, <i>M</i><sub>22</sub> = 0.0681, 
pa je <i>k</i><sub>5</sub> = 4.  
</ul>
Stoga je kljuèna rijeè &nbsp; 
<font color=990099>MATHE</font>,   
a traženi otvoreni tekst glasi: 
<pre><font size="+1" color=990000>
USPJE HURJE SAVAN JUNEP OZNAT IHSIF ARAMJ ERISE OVIMC ETIRI
MAPOK AZATE LJIMA REDOM KAKOS UOVDJ ENAVE DENIU PORNO SCUPA
ZSILJ IMPOS TUPCI MAANA LIZEI NTUIC IJOMI SRECO MSPOS OBNOS
TDASE ZNABA REMCI TATIJ EZIKO RIGIN ALNOG TEKST AVEOM AJEPO 
ZELJN AALIN IJEBI TNA
</font></pre>

ili, s umetnutim "kvaèicama", razmacima i interpunkcijom:
<p><font color=990000>
Uspjeh u rješavanju nepoznatih šifara mjeri se ovim èetirima
pokazateljima, redom kako su ovdje navedeni: upornošæu,
pažljivim postupcima analize, intuicijom i sreæom. Sposobnost
da se zna barem èitati jezik originalnog teksta veoma je
poželjna, ali nije bitna.
</font><p>
Tako glase prve dvije reèenice "Udžbenika za rješavanje vojnih
šifara" autora <font color=009900>Parkera Hitta</font>,
jednog od najpoznatijih
amerièkih kriptografa iz vremena Prvog svjetskog rata.
<p>

<hr size=2 noshade>

<b><font size="-1" face="Verdana">
<a href="supst.html">[Prethodno poglavlje]</a> &nbsp; 
<a href="playfair.html">[Sljedeæe poglavlje]</a> &nbsp; 
<a href="kriptografija.html">[Sadržaj]</a>
</font></b>

<hr size=2 noshade>


<table border="0" width="100%">
<tr valign="bottom">
<td>
<a href="../kript.html">Web stranica kolegija <em>Kriptografija</em></a>
</td>

<td align="right">
<a href="../index.html"><em>Andrej Dujella</em> - osobna stranica</a>
</td>
</tr>
</table>

<!-- Start eXTReMe Non Public Tracker Code V3/5
Login:    duje
Help:     https://www.extremetracking.com -->
<script type="text/javascript"><!--
EXs=screen;EXw=EXs.width;navigator.appName!="Netscape"?
EXb=EXs.colorDepth:EXb=EXs.pixelDepth;
navigator.javaEnabled()==1?EXjv="y":EXjv="n";
EXd=document;EXw?"":EXw="na";EXb?"":EXb="na";
location.protocol=="https:"?EXprot="https":EXprot="http";
top.document.referrer?EXref=top.document.referrer:EXref=EXd.referrer;
EXd.write("<img src="+EXprot+"://nht-2.extreme-dm.com",
"/n2.g?login=duje&amp;url="+escape(document.URL)+"&amp;pv=&amp;",
"jv="+EXjv+"&amp;j=y&amp;srw="+EXw+"&amp;srb="+EXb+"&amp;",
"l="+escape(EXref)+" height=1 width=1>");//-->
</script><noscript><div id="nneXTReMe"><img height="1" width="1" alt=""
src="http://nht-2.extreme-dm.com/n2.g?login=duje&amp;url=nojs&amp;j=n&amp;jv=n&amp;pv=" />
</div></noscript>
<!-- End eXTReMe Non Public Tracker Code -->

<script type="text/javascript" src="https://web.math.pmf.unizg.hr/lib/js/accessibility_black.min.js"></script>

</body>
</html>
