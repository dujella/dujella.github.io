<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Implementacija osnovnih operacija na eliptièkim 
krivuljama</title>

<meta name="author" content="Andrej Dujella">
<meta name="description" content="Implementacija 
operacija na eliptièkim krivuljama">
<meta name="keywords" content="eliptièke krivulje">

<meta http-equiv="Content-Type" content="text/html; charset=windows-1250">

<style type="text/css">
body {font-family: Arial,Helvetica,sans-serif;}
</style>

</head>

<body bgcolor="#FFFFFF">

<b><font size="-1" face="Verdana">
<a href="hasse.html">[Prethodna tema]</a> &nbsp; 
<a href="menezes.html">[Sljedeæa tema]</a>  
</font></b>

<hr size=2 noshade>


<h2 align=center style="color: rgb(128,0,0)">5.3. Implementacija 
osnovnih operacija na eliptièkim krivuljama</h2>

Da bi neka grupa <i>G</i> mogla poslužiti kao osnova za  
kriptosustav s javnim kljuèem, nužno je da se u toj grupi 
množenje (grupovna operacija) i potenciranje mogu efikasno 
provesti. Buduæi da grupovnu operaciju na eliptièkoj krivulji 
zapisujemo aditivno, govorimo o <em>zbrajanju toèaka</em> i 
<em>višekratniku toèke</em>: 
<p align=center>
[<i>k</i>] <i>P</i> = <i>P</i> + <i>P</i> + ... +  <i>P</i> 
&nbsp; (<i>k</i> pribrojnika).
</p>

Iz formula za zbrajanje toèaka vidimo da u sluèaju kada je 
<i>P</i> <img src="symbols/ne.gif" alt="<>" ALIGN=TOP> <i>Q</i>, 
raèunanje koordinata toèke <i>P</i> + <i>Q</i> zahtijeva 
jedno raèunanje inverza u polju, te tri množenja u polju 
(1I + 3M) (zanemarujemo "trošak" za zbrajanje u polju, te množenje 
malim konstantama). Kada je <i>P</i> = <i>Q</i>, onda je trošak 
za udvostruèavanje toèke jednak 1I + 4M. <br>

Ovo je razmatranje bilo za sluèaj char 
<img src="symbols/ne.gif" alt="<>" ALIGN=TOP> 2, 3. Ako je char = 2, 
situacija je slièna, osim što je u tom sluèaju trošak kvadriranja 
zanemariv u odnosnu na obièno množenje, pa zato dobivamo 1I + 2M.  <p>

Inverz u konaènom polju se raèuna pomoæu Euklidovog algoritma. 
Iako je njegova kompleksnost teoretski usporediva s 
kompleksnošæu množenja, u praksi je množenje ipak dosta 
brže od raèunanja inverza.  
Raèunanje inverza u polju može se izbjeæi uvoðenjem 
<em>težinskih projektivnih koordinata</em>, gdje 
(<i>X</i>, <i>Y</i>, <i>Z</i>) odgovara 
(<i>X</i> / <i>Z</i><sup>2</sup>, <i>Y</i> / <i>Z</i><sup>3</sup>). 
Tada jednadžba eliptièke krivulje (za char 
<img src="symbols/ne.gif" alt="<>" ALIGN=TOP> 2, 3) postaje
<p align=center>
<i>Y</i><sup>2</sup> = <i>X</i><sup>3</sup> + 
<i>aXZ</i><sup>4</sup> + <i>bZ</i><sup>6</sup>. 
</p>
Sada se kod raèunanja zbroja dvaju toèaka uopæe ne 
pojavljuje djeljenje. 
Na taj naèin, trošak za raèunanje <i>P</i> + <i>Q</i> postaje 16M, 
a za raèunanje [2]<i>P</i> trošak je 10M. 
Na primjer, koordinate toèke 
(<i>X</i><sub>2</sub>, <i>Y</i><sub>2</sub>, <i>Z</i><sub>2</sub>) = 
[2] (<i>X</i>, <i>Y</i>, <i>Z</i>)
se mogu izraèunati na sljedeæi naèin: 
<p align=center>
<i>m</i><sub>1</sub> = 3<i>X</i><sup>2</sup> + <i>a</i><i>Z</i><sup>4</sup>, &nbsp; &nbsp; 
<i>m</i><sub>2</sub> = 4<i>X</i><i>Y</i><sup>2</sup>, &nbsp; &nbsp; 
<i>m</i><sub>3</sub> = <i>Y</i><sup>4</sup>, <br>
<i>X</i><sub>2</sub> = (<i>m</i><sub>1</sub>)<sup>2</sup> 
- 2<i>m</i><sub>2</sub>, &nbsp; &nbsp;  
<i>Y</i><sub>2</sub> = <i>m</i><sub>1</sub>(<i>m</i><sub>2</sub>   
- <i>X</i><sub>2</sub>) - <i>m</i><sub>3</sub>, &nbsp; &nbsp;  
<i>Z</i><sub>2</sub> = 2<i>Y</i><i>Z</i>.



<p><br>

Raèunanje višekratnika toèke na eliptièkoj krivulji, specijalni 
je sluèaj opæeg problema potenciranja u abelovoj grupi. 
Stoga se mogu primijeniti razni algoritmi koji su poznati za 
taj opæi problem. 
<p>
Najjednostavnija (i najstarija) efikasna metoda za raèunanje
višekratnika toèaka koristi binarni zapis broja <i>k</i>. 
Zove se <em>binarna metoda</em> ili <em>metoda uzastopnog 
kvadriranja</em>. Na primjer, binarni zapis broja 100 je 
(1100100)<sub>2</sub>. Sada toèku [100] <i>P</i> možemo izraèunati 
kao [2]([2](<i>P</i> + [2]([2]([2](<i>P</i> + [2]<i>P</i>))))).
<p>

<table align=center border=1 width="95%" cellpadding=15> 
<tr><td bgcolor="FFFFCC">
<font face="Arial,Helvetica,sans-serif">

<b>ALGORITAM:</b><br><br>
INPUT: toèka <i>P</i> i <i>g</i>-bitni 
prirodni broj <i>k</i> = 
<img src="symbols/sum.gif" alt="SUMA" ALIGN=MIDDLE> 
<i>k</i><sub><i>j</i></sub> 2<sup><i>j</i></sup>, 
<i>k</i><sub><i>j</i></sub> <img src="symbols/in.gif" alt="in" ALIGN=TOP> 
{0,1}  <br>
OUTPUT: toèka <i>Q</i> = [<i>k</i>] <i>P</i>

<ol>
<li> <i>Q</i> <img src="symbols/leftarrow.gif" alt="<--" ALIGN=TOP>
<img src="symbols/calo.gif" alt="O" ALIGN=TOP> 
<li> For <i>j</i> = <i>g</i> - 1 to 0 by -1 do:
<li> &nbsp; &nbsp; &nbsp; <i>Q</i> 
<img src="symbols/leftarrow.gif" alt="<--" ALIGN=TOP> [2] <i>Q</i> 
<li> &nbsp; &nbsp; &nbsp; If <i>k</i><sub><i>j</i></sub> = 1 
then <i>Q</i> <img src="symbols/leftarrow.gif" alt="<--" ALIGN=TOP>
<i>Q</i> + <i>P</i>
<li> Return <i>Q</i>
</ol>
</font></td></tr></table>

<p>
Broj "bitnih" operacija za raèunanje [<i>k</i>] <i>P</i> pomoæu 
ovog algoritma je O(log <i>k</i> log<sup>3</sup> <i>q</i>). 
<p>

Poznato je više opæih poboljšanja binarne metode. Meðutim, 
postoji je jedno poboljšanje koje je prilièno specifièno za 
eliptièke krivulje. Naime, za razliku od nekih drugih grupa, 
kod eliptièkih krivulja inverzna operacija (oduzimanje) 
ima doslovno isti trošak kao i originalna grupovna operacija 
(zbrajanje). To je zbog toga što vrijedi 
-(<i>x</i>, <i>y</i>) = (<i>x</i>, -<i>y</i>) za char 
<img src="symbols/ne.gif" alt="<>" ALIGN=TOP> 2,  dok je 
-(<i>x</i>, <i>y</i>) = (<i>x</i>, <i>x</i> + <i>y</i>) za char = 2. 
<p>
Ova èinjenica nas motivira za umjesto binarnog prikaza 
broja <i>k</i>, koristimo tzv. SD (<em>signed digit</em>) prikaz 
oblika 
<i>k</i> = 
<img src="symbols/sum.gif" alt="SUMA" ALIGN=MIDDLE> 
<i>s</i><sub><i>j</i></sub> 2<sup><i>j</i></sup>, 
<i>k</i><sub><i>j</i></sub> <img src="symbols/in.gif" alt="in" ALIGN=TOP> 
{-1,0,1}.  
Jasno je da ovakav prikaz nije jedinstven. Npr. 3 = (0 1 1) = 
(1 0 -1). Stoga možemo pokušati izabrati prikaz koji æe voditi 
do što efikasnijeg algoritma. Reæi æemo da je SD prikaz 
<em>rijedak</em> ili <em>nesusjedni</em> (non-adjacent form, NAF) 
ako nema susjednih znamenaka razlièitih od 0, tj. ako je 
<i>s</i><sub><i>j</i></sub> <i>s</i><sub><i>j</i>+1</sub> = 0, 
za svaki <i>j</i>. Poznato je da svaki prirodan broj <i>k</i> ima 
jedinstveni NAF, te da NAF ima najmanju težinu (broj 
<i>s</i><sub><i>j</i></sub>-tova razlièitih od 0), meðu svim 
SD prikazima od <i>k</i>. Oèekivana težina NAF-a je <i>g</i>/3, 
za razliku od binarnog prikaza kod kojeg je oèekivana težina 
<i>g</i>/2.  

<p>
<hr size=2 noshade>

<h4 style="color: rgb(128,0,0)">Zadatci:</h4>

<ol>
<li> Zadana je toèka <i>P</i> = (0,376) na eliptièkoj 
krivulji 
<i>y</i><sup>2</sup> = <i>x</i><sup>3</sup> - <i>x</i> + 188 
nad poljem <img src="symbols/bbf.gif" alt="F" ALIGN=TOP><sub>751</sub>. 
Izraèunajte [100] <i>P</i>.
<p>
<li> Za sve prirodne brojeve izmeðu 100 i 200 odredite 
njihov NAF prikaz. 
<p>
<li> Uvjerite se da sljedeæi algoritam iz poznatog 
binarnog zapisa (<i>k</i><sub><i>g</i> -1</sub>, ... , 
<i>k</i><sub>1</sub>, <i>k</i><sub>0</sub>) broja <i>k</i> 
raèuna njegov NAF prikaz 
(<i>s</i><sub><i>g</i></sub>, ... , 
<i>s</i><sub>1</sub>, <i>s</i><sub>0</sub>):
<blockquote>
<font face="Times New Roman">
<i>c</i><sub>0</sub> = 0 <br>
<tt><b>For</b></tt> &nbsp; <i>j</i> = 0  
&nbsp; <tt><b>to</b></tt> &nbsp; <i>g</i> &nbsp; <tt><b>do</b></tt> <br>
&nbsp; &nbsp; &nbsp; &nbsp; 
<i>c</i><sub><i>j</i> + 1</sub> = 
<img src="symbols/lfloor.gif" alt="[" ALIGN=TOP>(<i>k</i><sub><i>j</i></sub> + <i>k</i><sub><i>j</i> + 1</sub> 
+ <i>c</i><sub><i>j</i></sub>) / 2<img src="symbols/rfloor.gif" alt="]" ALIGN=TOP> <br>
&nbsp; &nbsp; &nbsp; &nbsp; <i>s</i><sub><i>j</i></sub> = 
<i>k</i><sub><i>j</i></sub> + <i>c</i><sub><i>j</i></sub> 
- 2<i>c</i><sub><i>j</i> + 1</sub>.
</font>

</ol>
<p>

 

<hr size=2 noshade>

<b><font size="-1" face="Verdana">
<a href="hasse.html">[Prethodna tema]</a> &nbsp; 
<a href="menezes.html">[Sljedeæa tema]</a>  
</font></b>

<hr size=2 noshade>


<table border="0" width="100%">
<tr valign="bottom">
<td>
<a href="../ecc/eccseminar.html">Web stranica seminara</em></a>
</td>

<td align="right">
<a href="../index.html"><em>Andrej Dujella</em> - osobna stranica</a>
</td>
</tr>
</table>


</body>
</html>



 





